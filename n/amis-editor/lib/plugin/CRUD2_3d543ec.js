amis.define("431f1e9",(function(e,a,t,n){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r=e("849c8c1"),i=e("5850c09"),o=e("cc4bbf0"),l=e("8ba532b"),c=e("520d1e1"),u=e("167c905"),d=e("8beedab"),b=e("fb32b1a");function f(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var s=f(i),p=f(o),v=function(e,a,t){for(var n=[e];n.length;){var r=n.pop();if(Array.isArray(r))n.push.apply(n,r);else if(!(!c.isObject(r)||t&&t(r))){if(a(r))return r;n.push.apply(n,Object.values(r))}}},m=function(e,a){for(var t=[e],n=function(){var e=t.pop();return Array.isArray(e)?(c.remove(e,a),t.push.apply(t,e),"continue"):c.isObject(e)?void Object.entries(e).forEach((function(n){var r=n[0],i=n[1];c.isObject(i)&&a(i)&&delete e[r],t.push(i)})):"continue"};t.length;)n()},y=[{label:b.i18n("a4313469fd7361486fe47076629c76ac"),value:"Insert",resolveSchema:function(e,a){void 0===e&&(e={});var t={type:"form",body:[],onEvent:{submitSucc:{actions:[{actionType:"search",componentId:e.id}]}}};return a.resolveCreateSchema({schema:t,setting:e,feat:"Insert",inCrud:!0}),{type:"button",behavior:"Insert",label:b.i18n("66ab5e9f24c8f46012a25c89919fb191"),level:"primary",className:"m-r-xs",onEvent:{click:{actions:[{actionType:"dialog",dialog:{title:b.i18n("50abd0bf31e07dbee84e9e5b9a407840"),body:t}}]}}}},align:"left"},{label:b.i18n("e73cefac9d030927da1618c7b15c98c9"),value:"BulkEdit",resolveSchema:function(e,a){void 0===e&&(e={});var t={type:"form",behavior:"BulkEdit",body:[],onEvent:{submitSucc:{actions:[{actionType:"search",componentId:e.id}]}}};return a.resolveCreateSchema({schema:t,setting:e,feat:"BulkEdit",inCrud:!0}),{type:"button",behavior:"BulkEdit",label:b.i18n("e73cefac9d030927da1618c7b15c98c9"),className:"m-r-xs",onEvent:{click:{actions:[{actionType:"dialog",dialog:{title:b.i18n("e73cefac9d030927da1618c7b15c98c9"),body:t}}]}},disabledOn:"selectedItems != null && selectedItems.length < 1"}},align:"left"},{label:b.i18n("7fb62b30119c3797a843a48368463314"),value:"BulkDelete",resolveSchema:function(e,a){var t,n,r;void 0===e&&(e={});var i={type:"button",className:"m-r-xs",label:b.i18n("7fb62b30119c3797a843a48368463314"),level:"danger",behavior:"BulkDelete",disabledOn:"selectedItems != null && selectedItems.length < 1"};return a.resolveDeleteSchema({schema:i,setting:e,feat:"BulkDelete"}),null===(r=null===(n=null===(t=i.onEvent)||void 0===t?void 0:t.click)||void 0===n?void 0:n.actions)||void 0===r||r.push({actionType:"search",componentId:e.id}),i},align:"left"},{label:b.i18n("73f28ac83b623fb81d73f16fb3856fa0"),value:"Import",resolveSchema:function(e,a){return{type:"button",className:"m-r-xs",label:b.i18n("8d9a071ee2ef45e045968e117a205c07"),behavior:"Import"}},align:"left"},{label:b.i18n("09d44261d7883bf5141a462a790d2816"),value:"Export",resolveSchema:function(e,a){return{type:"button",className:"m-r-xs",label:b.i18n("55405ea6ff6fd823ffab7e6b10ddfa95"),behavior:"Export"}},align:"left"}],h=[{label:b.i18n("6ff4bf3d567e977aa4c90c27dff1e6db"),value:"FuzzyQuery",resolveSchema:function(e,a){void 0===e&&(e={});var t=l.generateNodeId();return{type:"form",behavior:"FuzzyQuery",id:t,submitOnChange:!0,wrapWithPanel:!1,onEvent:{validateSucc:{actions:[{actionType:"search",componentId:e.id,args:{query:"${event.data}"}}]}},body:[{name:"keywords",type:"input-text",label:!1,addOn:{type:"button",label:b.i18n("e5f71fc31e7246dd6ccc5539570471b0"),onEvent:{click:{actions:[{actionType:"submit",componentId:t}]}}}}]}}},{label:b.i18n("c26996a6506adf397f0668d376d0b40b"),value:"SimpleQuery",resolveSchema:function(e,a){return void 0===e&&(e={}),{title:b.i18n("c26996a6506adf397f0668d376d0b40b"),type:"form",mode:"inline",behavior:"SimpleQuery",body:a.resolveSimpleFilterSchema({setting:e})||[],actions:[{type:"submit",label:b.i18n("bee912d79eefb7335988c4997aa9138d")},{type:"reset",label:b.i18n("4b9c3271dc2f299dc3aeffb369187513")}],onEvent:{validateSucc:{actions:[{actionType:"search",componentId:e.id,args:{query:{simpleFilters:"${event.data}"}}}]}}}}},{label:b.i18n("9c4666fd08c2738eb9611a3721cb5f0f"),value:"AdvancedQuery",resolveSchema:function(e,a){return void 0===e&&(e={}),{title:b.i18n("9c4666fd08c2738eb9611a3721cb5f0f"),type:"form",mode:"inline",behavior:"AdvancedQuery",body:a.resolveAdvancedFilterSchema({setting:e})||[],actions:[{type:"submit",label:b.i18n("bee912d79eefb7335988c4997aa9138d")},{type:"reset",label:b.i18n("4b9c3271dc2f299dc3aeffb369187513")}],onEvent:{validateSucc:{actions:[{actionType:"search",componentId:e.id,args:{query:{customFilters:"${event.data}"}}}]}}}}}],g=[{label:b.i18n("5b48dbb8dc710cffe6313bb56a7f6d47"),value:"View",resolveSchema:function(e,a){return void 0===e&&(e={}),{type:"button",label:b.i18n("607e7a4f377fa66b0b28ce318aab841f"),level:"link",behavior:"View",onEvent:{click:{actions:[{actionType:"dialog",dialog:{type:"form",title:b.i18n("607e7a4f377fa66b0b28ce318aab841f"),body:a.resolveViewSchema({setting:e})}}]}}}}},{label:b.i18n("e22b59b6bda1cf9a58f8979fd0a0b43c"),value:"Edit",resolveSchema:function(e,a){void 0===e&&(e={});var t={type:"form",body:[],onEvent:{submitSucc:{actions:[{actionType:"search",componentId:e.id}]}}};return a.resolveCreateSchema({schema:t,setting:e,feat:"Edit",inCrud:!0}),{type:"button",label:b.i18n("95b351c86267f3aedf89520959bce689"),level:"link",behavior:"Edit",onEvent:{click:{actions:[{actionType:"dialog",dialog:{title:b.i18n("95b351c86267f3aedf89520959bce689"),body:t}}]}}}}},{label:b.i18n("a790208cafd5c95a18dd9a168319ecf8"),value:"Delete",resolveSchema:function(e,a){var t,n,r;void 0===e&&(e={});var i={type:"button",className:"m-r-xs",label:b.i18n("2f4aaddde33c9b93c36fd2503f3d122b"),level:"link",behavior:"Delete"};return a.resolveDeleteSchema({schema:i,setting:e,feat:"Delete"}),null===(r=null===(n=null===(t=i.onEvent)||void 0===t?void 0:t.click)||void 0===n?void 0:n.actions)||void 0===r||r.push({actionType:"search",componentId:e.id}),i}}],S=function(e){function a(a){var t=e.call(this,a)||this;return Object.defineProperty(t,"disabledRendererPlugin",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(t,"dsBuilderMgr",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(t,"rendererName",{enumerable:!0,configurable:!0,writable:!0,value:"crud2"}),Object.defineProperty(t,"multifactor",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(t,"$schema",{enumerable:!0,configurable:!0,writable:!0,value:"/schemas/CRUD2Schema.json"}),Object.defineProperty(t,"order",{enumerable:!0,configurable:!0,writable:!0,value:-1e3}),Object.defineProperty(t,"docLink",{enumerable:!0,configurable:!0,writable:!0,value:"/amis/zh-CN/components/crud"}),Object.defineProperty(t,"tags",{enumerable:!0,configurable:!0,writable:!0,value:[b.i18n("73721e611daaafe5c34aa9f3f901d016")]}),Object.defineProperty(t,"scaffold",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(t,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(t,"events",{enumerable:!0,configurable:!0,writable:!0,value:[{eventName:"get-data",eventLabel:b.i18n("1b79a4f49b7a21e62b8868f12189b0b0"),description:b.i18n("5a28d015b7b3518f75bc4cc27d9f6c20")}]}),Object.defineProperty(t,"actions",{enumerable:!0,configurable:!0,writable:!0,value:[{actionType:"search",actionLabel:b.i18n("cfd84204d9476936c949d071cc2338cf"),description:b.i18n("c6bd3393c21379d3f75d179abe36da3d"),descDetail:function(e){return p.default.createElement("div",null,p.default.createElement("span",{className:"variable-right"},null==e?void 0:e.__rendererLabel),"触发数据查询")},schema:d.getArgsWrapper({name:"query",label:b.i18n("cf12e55021998a8328201800ec356773"),type:"ae-formulaControl",variables:"${variables}",size:"md",mode:"horizontal"})},{actionType:"loadMore",actionLabel:b.i18n("77281549955309c49f5eef77838a85e5"),description:b.i18n("b3a4d6a345372c5def1d5a1bf6077bce"),descDetail:function(e){return p.default.createElement("div",null,p.default.createElement("span",{className:"variable-right"},null==e?void 0:e.__rendererLabel),"加载更多数据")}}]}),Object.defineProperty(t,"previewSchema",{enumerable:!0,configurable:!0,writable:!0,value:{syncLocation:!1,type:"crud2",className:"text-left",bodyClassName:"m-b-none",affixHeader:!1,data:{items:[{a:1,b:2},{a:3,b:4},{a:5,b:6}]},source:"${items}",columns:[{title:"A",name:"a"},{title:"B",name:"b"},{name:"operation",title:b.i18n("2b6bc0f293f5ca01b006206c2535ccbc"),buttons:[{icon:"fa fa-eye",type:"button"},{icon:"fa fa-edit",type:"button"}]}]}}),t.dsBuilderMgr=new l.DSBuilderManager("crud2","api"),t}return r.__extends(a,e),Object.defineProperty(a.prototype,"afterBuildPanelBody",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var a;return r.__awaiter(this,void 0,void 0,(function(){var t;return r.__generator(this,(function(n){switch(n.label){case 0:return t=e.context.context,(null===(a=t.info.renderer)||void 0===a?void 0:a.isFormItem)&&new RegExp("/crud2/filter/").test(t.path)?[4,this.addFilterPanelSetting(e.context)]:[3,2];case 1:return n.sent(),[3,3];case 2:"crud2"===t.schema.type&&t.schema.mode===this.scaffold.mode&&this.addListPanelSetting(e.context),n.label=3;case 3:return[2]}}))}))}}),Object.defineProperty(a.prototype,"addFilterPanelSetting",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var a;return r.__awaiter(this,void 0,void 0,(function(){var t,n,i,o,l,c;return r.__generator(this,(function(u){switch(u.label){case 0:return t=e.context,n=t.info,i=t.node,(null===(a=n.renderer)||void 0===a?void 0:a.isFormItem)?(o=i.getClosestParentByType("form"),(l=i.getClosestParentByType("crud2"))&&o&&o.schema.behavior&&l.schema.mode===this.scaffold.mode?[4,this.dsBuilderMgr.resolveBuilderBySchema(l.schema,"api").makeFieldFilterSetting({schema:l.schema,sourceKey:"api",fieldName:i.schema.name})]:[2]):[3,2];case 1:if(!(c=u.sent())||!c.length)return[2];e.data.tabs.forEach((function(e){e.title===b.i18n("24d67862f87f439db7ca957aecb77cce")&&e.body[0].body.forEach((function(e){var a;e.title===b.i18n("4092ed98e9035652d4c9ca9441701ed7")&&(a=e.body).splice.apply(a,r.__spreadArray([2,0],c,!1))}))})),u.label=2;case 2:return[2]}}))}))}}),Object.defineProperty(a.prototype,"addDataOperatorSchema",{enumerable:!1,configurable:!0,writable:!0,value:function(e,a){}}),Object.defineProperty(a.prototype,"addFeatToToolbar",{enumerable:!1,configurable:!0,writable:!0,value:function(e,a,t,n){var r="".concat(t,"Toolbar");e[r]=e[r]||[{type:"grid",columns:[{body:[]},{columnClassName:"text-right",body:[]}]}];try{e[r][0].columns["left"===n?0:1].body.unshift(a)}catch(t){e[r].unshift(a)}}}),Object.defineProperty(a.prototype,"filterOperators",{enumerable:!1,configurable:!0,writable:!0,value:function(e,a){var t=this,n=[];return y.forEach((function(a){e.features.includes(a.value)&&n.push(r.__assign(r.__assign({},a),{remove:function(e){m(e.headerToolbar,(function(e){return e.behavior===a.value})),m(e.footerToolbar,(function(e){return e.behavior===a.value}))},add:function(n){t.addFeatToToolbar(n,a.resolveSchema(n,e),"header",a.align)},isActive:function(e){return t.isFeatActive(e,a.value,"headerToolbar","footerToolbar")}}))})),"table2"===a.schema.mode&&g.forEach((function(a){e.features.includes(a.value)&&n.push(r.__assign(r.__assign({},a),{remove:function(e){m(e.columns,(function(e){return e.behavior===a.value}))},add:function(n){t.addDataOperatorSchema(n,a.resolveSchema(n,e))},isActive:function(e){return t.isFeatActive(e,a.value,"columns")}}))})),n}}),Object.defineProperty(a.prototype,"makeFeatSetting",{enumerable:!1,configurable:!0,writable:!0,value:function(e,a,t){return e.makeSetting?e.makeSetting(a):a.makeFieldsSettingForm({feat:e.value,inCrud:!0,inScaffold:t})}}),Object.defineProperty(a.prototype,"isFeatActive",{enumerable:!1,configurable:!0,writable:!0,value:function(e,a){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];if(0===t.length)return v(e,(function(e){return e.behavior===a}));for(var r=null;r=t.shift();)if(v(e[r],(function(e){return e.behavior===a})))return!0;return!1}}),Object.defineProperty(a.prototype,"removeFeatSchema",{enumerable:!1,configurable:!0,writable:!0,value:function(e,a){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];if(0===t.length)return m(e,(function(e){return e.behavior===a}));for(var r=null;r=t.shift();)m(e[r],(function(e){return e.behavior===a}));return!1}}),Object.defineProperty(a.prototype,"filterColumns",{enumerable:!1,configurable:!0,writable:!0,value:function(e,a){var t,n,r,i=[],o=[],l=this.manager.store.getNodeById(a.id);if(!l)return o;var c=(null===(n=null===(t=l.children.find((function(e){return"table2"===e.type})))||void 0===t?void 0:t.children[0])||void 0===n?void 0:n.children)||[],u=null===(r=l.schema.columns)||void 0===r?void 0:r.some((function(e){return"operation"===e.type}));if(c.some((function(e,a){var t;return 0!==a&&e.id===c[0].id||(e.schema&&o.push({label:e.schema.title,value:e.id}),(null===(t=e.schema)||void 0===t?void 0:t.key)&&i.push(e.schema.key),!1)})),l.schema.__fields){var d=e.makeTableColumnsByFields(l.schema.__fields);(null==d?void 0:d.length)&&d.forEach((function(e){i.includes(e.name)||o.push({label:e.title,value:null,add:function(a){a.columns.push(e)},isActive:function(){return!1}})}))}return u||o.push({label:b.i18n("39ccc34fa3ee9be12d8bae7e6fecbac2"),value:null,isActive:function(){return!1},add:function(e){e.columns.push({type:"operation",title:b.i18n("2b6bc0f293f5ca01b006206c2535ccbc"),buttons:[]})}}),o}}),Object.defineProperty(a.prototype,"addListPanelSetting",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var a=this,t=e.data,n=this.dsBuilderMgr.resolveBuilderBySchema(e.context.schema,"api");t.tabs.forEach((function(t){var i,o;if(t.title===b.i18n("24d67862f87f439db7ca957aecb77cce")){t.body[0].body.forEach((function(t){var i;t.title===b.i18n("4092ed98e9035652d4c9ca9441701ed7")&&(i=t.body).unshift.apply(i,r.__spreadArray(r.__spreadArray([],n.makeSourceSettingForm({name:"api",label:b.i18n("c11322c9cc43ce3c004cf03f5ac0acd0"),feat:"List",inCrud:!0}),!1),[l.getSchemaTpl("interval"),l.getSchemaTpl("switch",{name:"syncLocation",label:l.tipedLabel(b.i18n("569343b4fe5e48131b78611c11eadbeb"),b.i18n("6dbee29a8c54eef9d042ef3280999ad9")),pipeIn:l.defaultValue(!0)}),l.getSchemaTpl("switch",{label:b.i18n("240145572215920ae06db1eeb85b29c0"),name:"selectable"}),l.getSchemaTpl("switch",{name:"keepItemSelectionOnPageChange",label:l.tipedLabel(b.i18n("099cf136d6a4b6ed4646af4a2ed066b2"),b.i18n("60011314ed92794f3d4f3e874c359279")),visbileOn:"this.selectable"})],!1)),t.title===b.i18n("949a8b7bd2c10070a2fae16f9c66afbb")&&(t.body.unshift(l.getSchemaTpl("switch",{name:"columnsTogglable",label:l.tipedLabel(b.i18n("2816cea6c4887a53c417831deb5fbe00"),b.i18n("d3c5079f7e26b1a7374ff76341376de4")),onChange:function(e,t,n,r){var i=s.default(r.data);!0===e?a.addFeatToToolbar(i,{type:"column-toggler"},"header","right"):m(i.headerToolbar,(function(e){return"column-toggler"===e.type})),r.setValues(i)}})),t.body.unshift({type:"ae-feature-control",label:!1,features:function(){return a.filterColumns(n,e.context)},goFeatureComp:function(e){return e.value},removeFeature:function(e){a.manager.del(e.value)},manager:a.manager,addable:!0,removeable:!0}))}));var c=l.getSchemaTpl("collapseGroup",[{title:b.i18n("4a3ebd0ef27212de3b0c39e6a9701b1d"),order:2,body:h.map((function(e){if(!n.features.includes(e.value))return null;var t=[],i={label:e.label,name:"__".concat(e.value),pipeIn:function(t,n){return"FuzzyQuery"===e.value?a.isFeatActive(n.data,e.value,"headerToolbar","footerToolvar"):a.isFeatActive(n.data,e.value,"filter")},onChange:function(t,r,i,o){var l=s.default(o.data);!0===t?"FuzzyQuery"===e.value?a.addFeatToToolbar(l,e.resolveSchema(l,n),"header","right"):l.filter.push(e.resolveSchema(l,n)):!1===t&&a.removeFeatSchema(l,e.value),o.setValues(l)}};return t&&t.length?r.__assign(r.__assign({},i),{type:"ae-switch-more",formType:"extend",mode:"normal",form:{body:t}}):l.getSchemaTpl("switch",i)}))},{title:b.i18n("a9a3a4608d48214efbdfac99888f6e0f"),order:3,body:[{type:"ae-feature-control",label:!1,features:a.filterOperators(n,e.context),goFeatureComp:function(a){var t,n=e.context.node;return n.isSecondFactor&&(n=n.parent),null===(t=u.findTree(n.children,(function(e){return e.schema.behavior===a.value})))||void 0===t?void 0:t.id},manager:a.manager,addable:!0,addText:b.i18n("84a2f40385427bbf2edc79e3368e4e0f"),removeable:!0}]},{title:b.i18n("cb43abed5ba14bf32fbb1058e12d2303"),order:4,body:[{type:"select",label:b.i18n("48b42e5c3ea447092eaf0a1a13195540"),name:"__pgType",options:[{label:b.i18n("d81bb206a889656035b929cd8bb1ef10"),value:"none"},{label:b.i18n("3862626c138ce5945e0e273a1bdfbad0"),value:"Pagination"},{label:b.i18n("77281549955309c49f5eef77838a85e5"),value:"LoadMore"}].filter((function(e){return e})),pipeIn:function(e,a){var t=v([].concat(a.data.headerToolbar).concat(a.data.footerToolbar),(function(e){return e&&["Pagination","LoadMore"].includes(e.behavior)}));return(null==t?void 0:t.behavior)||"none"},onChange:function(e,t,n,r){var i=s.default(r.data),o=[].concat(i.headerToolbar).concat(i.footerToolbar);if("none"===e)m(o,(function(e){return e&&["Pagination","LoadMore"].includes(e.behavior)}));else{var l,c=void 0;"Pagination"===e?(l="LoadMore",c={type:"pagination",behavior:e,layout:["total","perPage","pager","go"]}):(l="Pagination",c={type:"button",behavior:e,label:b.i18n("77281549955309c49f5eef77838a85e5"),onEvent:{click:{actions:[{actionType:"loadMore",componentId:i.id}]}}}),m(o,(function(e){return e&&e.behavior===l})),a.addFeatToToolbar(i,c,"footer","right")}r.setValues(i)}},l.getSchemaTpl("switch",{label:l.tipedLabel(b.i18n("16b8ff2b147382be4cf8654f829df904"),b.i18n("d2e20bb1e977f9571a9e2d1b39a7ff10")),name:""})]}]);(i=t.body[0].body).splice.apply(i,r.__spreadArray([1,0],c.body,!1)),(o=t.body[0].activeKey).push.apply(o,c.activeKey)}}))}}),Object.defineProperty(a.prototype,"getScaffoldFeatureTab",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this,a=function(a,t){return e.dsBuilderMgr.collectFromBuilders((function(n,i){if(!n.features.includes(a.value))return null;var o=e.makeFeatSetting(a,n,!0);if(!o||0===o.length)return null;var l=!t||"data['".concat(t,"'] && ~data['").concat(t,"'].indexOf('").concat(a.value,"')");return{title:a.label,visibleOn:"(!data.dsType || data.dsType === '".concat(i,"') && ").concat(l),body:o.filter((function(e){return e})).map((function(e){return r.__assign(r.__assign({},e),{mode:"normal"})}))}}))};return c.flattenDeep([a({label:b.i18n("46a0f3086dce242abe54e48bd86e0394"),value:"List",resolveSchema:function(){}}),y.map((function(e){return a(e,"tools")})),h.map((function(e){return a(e,"filters")})),g.map((function(e){return a(e,"operators")}))]).filter((function(e){return e}))}}),Object.defineProperty(a.prototype,"resolveListField",{enumerable:!1,configurable:!0,writable:!0,value:function(e,a,t){}}),Object.defineProperty(a.prototype,"scaffoldForm",{get:function(){var e=this;return{title:"".concat(this.name,"创建向导"),mode:{mode:"horizontal",horizontal:{leftFixed:"sm"}},className:"ae-Scaffold-Modal ae-formItemControl",stepsBody:!0,body:[{title:b.i18n("d75a7984d3fa5b32f5d8312e899aeea8"),body:r.__spreadArray([this.dsBuilderMgr.getDSSwitch({onChange:function(e,a,t,n){if(e!==a){var r=n.data;Object.keys(r).forEach((function(e){(e.endsWith("Fields")||e.endsWith("api"))&&n.deleteValueByName(e)})),n.deleteValueByName("__fields")}return e}})],this.dsBuilderMgr.collectFromBuilders((function(e,a){return{type:"container",visibleOn:"dsType == null || dsType === '".concat(a,"'"),body:c.flattenDeep([e.makeSourceSettingForm({feat:"List",inScaffold:!0,inCrud:!0})])}})),!0)},{title:b.i18n("c2f1f9254c245976e346377515c2e578"),body:r.__spreadArray(r.__spreadArray([],this.dsBuilderMgr.collectFromBuilders((function(e,a){var t=function(a){return null==l.DSFeature[a.value]||e.features.includes(a.value)};return{type:"container",visibleOn:"dsType == null || dsType === '".concat(a,"'"),body:[{type:"checkboxes",label:b.i18n("012f602372cd2dbd639cd966c63e1f90"),name:"tools",joinValues:!1,extractValue:!0,multiple:!0,options:y.filter(t)},{type:"checkboxes",label:b.i18n("0943d61befec4c6cf2d21d170c9b066e"),name:"filters",multiple:!0,joinValues:!1,extractValue:!0,options:h.filter(t)},{type:"checkboxes",label:b.i18n("5246d2c81fa12b1f4f73635c257e232d"),name:"operators",multiple:!0,joinValues:!1,extractValue:!0,options:g.filter(t)},{type:"container"}]}})),!0),[{type:"tabs",tabsMode:"vertical",className:"ae-Scaffold-Modal-Tabs",tabs:this.getScaffoldFeatureTab()}],!1)}],pipeIn:function(a){return(null==a?void 0:a.$$m)||{dsType:e.dsBuilderMgr.getDefaultBuilderName()}},pipeOut:function(a){var t,n=s.default(e.scaffold),r=e.dsBuilderMgr.resolveBuilderBySetting(a);return r?(r.resolveSourceSchema({schema:n,feat:"List",setting:a,name:"api",inCrud:!0}),n.id=null!==(t=n.id)&&void 0!==t?t:l.generateNodeId(),a.id=n.id,n.$$m=a,a.filters&&(n.filter=[],h.forEach((function(t){a.filters.includes(t.value)&&("FuzzyQuery"!==t.value?n.filter.push(t.resolveSchema(a,r)):e.addFeatToToolbar(n,t.resolveSchema(a,r),"header","right"))}))),a.tools&&(y.concat().reverse().forEach((function(t){a.tools.includes(t.value)&&e.addFeatToToolbar(n,t.resolveSchema(a,r),"header",t.align)})),a.tools.find((function(e){return["BulkEdit","BulkDelete"].includes(e)}))&&(n.multiple=!0,n.selectable=!0)),e.resolveListField(a,n,r),e.addFeatToToolbar(n,{type:"pagination",behavior:"Pagination",layout:["total","perPage","pager","go"]},"footer","right"),n):n},canRebuild:!0}},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"getRendererInfo",{enumerable:!1,configurable:!0,writable:!0,value:function(a){var t=a.renderer,n=a.schema;if(this.scaffold&&"crud2"===t.name&&n.mode===this.scaffold.mode)return e.prototype.getRendererInfo.call(this,a)}}),Object.defineProperty(a.prototype,"buildDataSchemas",{enumerable:!1,configurable:!0,writable:!0,value:function(e,a){var t,n,i;return r.__awaiter(this,void 0,void 0,(function(){var o,l,u,d,f;return r.__generator(this,(function(s){switch(s.label){case 0:return o=e.children.find((function(e){return!!~["table2","cards","list"].indexOf(e.type)})),(u=this.dsBuilderMgr.resolveBuilderBySchema(e.schema,"api"))&&e.schema.api?[4,u.getContextFileds({schema:e.schema,sourceKey:"api",feat:"List"})]:[3,2];case 1:(d=s.sent())&&(l={type:"object",properties:c.fromPairs(d.map((function(e){return[e.value,{type:e.valueType||"string",title:e.label}]})))}),s.label=2;case 2:return null!=l?[3,4]:[4,null===(n=null==o?void 0:(t=o.info.plugin).buildDataSchemas)||void 0===n?void 0:n.call(t,o,a)];case 3:f=s.sent(),l=null===(i=null==f?void 0:f.properties)||void 0===i?void 0:i.items,s.label=4;case 4:return[2,{$id:"crud2",type:"object",properties:r.__assign(r.__assign({},l.properties),{items:r.__assign(r.__assign({},l),{title:b.i18n("fe9e25f4e4b3aeefeb9b7a9c368ede7e")}),selectedItems:r.__assign(r.__assign({},l),{title:b.i18n("2c77cfaef73ce2e81131861e9c6d670e")}),unSelectedItems:r.__assign(r.__assign({},l),{title:b.i18n("9c9153c49491c381dc2adb2c36fccb04")}),page:{type:"number",title:b.i18n("9a4fe969f1066e197fd2369a44d879ac")},total:{type:"number",title:b.i18n("a7f33a2d99056edcdaced5c8841a9bcb")}})}]}}))}))}}),Object.defineProperty(a.prototype,"getAvailableContextFields",{enumerable:!1,configurable:!0,writable:!0,value:function(e,a,t){return r.__awaiter(this,void 0,void 0,(function(){var t;return r.__generator(this,(function(n){return(t=this.dsBuilderMgr.resolveBuilderBySchema(e.schema,"api"))&&e.schema.api?[2,t.getAvailableContextFileds({schema:e.schema,sourceKey:"api",feat:"List"},a)]:[2]}))}))}}),a}(l.BasePlugin),_=function(e){function a(){var a=null!==e&&e.apply(this,arguments)||this;return Object.defineProperty(a,"name",{enumerable:!0,configurable:!0,writable:!0,value:b.i18n("b339aa87104709397ba68e7ebbc6e5ba")}),Object.defineProperty(a,"isBaseComponent",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(a,"description",{enumerable:!0,configurable:!0,writable:!0,value:b.i18n("7a9f1ec32752de8b69ef21138970f64d")}),Object.defineProperty(a,"order",{enumerable:!0,configurable:!0,writable:!0,value:-1e3}),Object.defineProperty(a,"icon",{enumerable:!0,configurable:!0,writable:!0,value:"fa fa-table"}),Object.defineProperty(a,"scaffold",{enumerable:!0,configurable:!0,writable:!0,value:{type:"crud2",mode:"table2",columns:[{name:"id",title:"ID",type:"container",body:[{type:"text"}]},{name:"engine",title:b.i18n("1a63ac23010e0573f7c0a8cd3314b8c6"),type:"container",body:[{type:"text"}]}]}}),Object.defineProperty(a,"panelTitle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),a}return r.__extends(a,e),Object.defineProperty(a.prototype,"resolveListField",{enumerable:!1,configurable:!0,writable:!0,value:function(e,a,t){var n;if(t.resolveTableSchema({schema:a,setting:e,inCrud:!0}),null===(n=e.operators)||void 0===n?void 0:n.length){var r=[];g.forEach((function(a){var n;(null===(n=e.operators)||void 0===n?void 0:n.includes(a.value))&&r.push(a.resolveSchema(e,t))})),a.columns.push({type:"operation",title:b.i18n("2b6bc0f293f5ca01b006206c2535ccbc"),buttons:r})}}}),a}(S),P=function(e){function a(){var a=null!==e&&e.apply(this,arguments)||this;return Object.defineProperty(a,"name",{enumerable:!0,configurable:!0,writable:!0,value:b.i18n("093c340f7e1fbde1928ca56b5c7f9cc4")}),Object.defineProperty(a,"isBaseComponent",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(a,"description",{enumerable:!0,configurable:!0,writable:!0,value:b.i18n("a0c35361a003527d123cb581f5c68f4b")}),Object.defineProperty(a,"order",{enumerable:!0,configurable:!0,writable:!0,value:-1e3}),Object.defineProperty(a,"icon",{enumerable:!0,configurable:!0,writable:!0,value:"fa fa-table"}),Object.defineProperty(a,"scaffold",{enumerable:!0,configurable:!0,writable:!0,value:{type:"crud2",mode:"cards",card:{type:"card2",body:[{type:"container",body:[{type:"tpl",tpl:b.i18n("32c65d8d7431e76029678ec7bb73a5ab"),inline:!1,style:{marginTop:"0",marginBottom:"0",paddingTop:"",paddingBottom:""},wrapperComponent:"h2"},{type:"form",body:[{type:"static-tpl",label:b.i18n("9caecd931b956381e0763d05aa42835c"),tpl:b.i18n("2d711b09bd0db0ad240cc83b30dd8014")}]},{type:"divider"},{type:"button-group"}]}]}}}),a}return r.__extends(a,e),Object.defineProperty(a.prototype,"resolveListField",{enumerable:!1,configurable:!0,writable:!0,value:function(e,a,t){var n,r=e.listFields;if(r&&r.length&&(a.card.body[0].body=t.resolveViewSchema({setting:e,feat:"List"}),null===(n=e.operators)||void 0===n?void 0:n.length)){var i=[];g.forEach((function(a){var n;(null===(n=e.operators)||void 0===n?void 0:n.includes(a.value))&&i.push(a.resolveSchema(e,t))})),a.card.body.push({type:"button-group",buttons:i})}}}),Object.defineProperty(a.prototype,"fillOperatorSchema",{enumerable:!1,configurable:!0,writable:!0,value:function(e,a){var t=e.columns.find((function(e){return"operators"===e.type}));t?t.buttons.push(a):e.columns.push({type:"operation",title:b.i18n("2b6bc0f293f5ca01b006206c2535ccbc"),buttons:[a]})}}),Object.defineProperty(a.prototype,"existOperator",{enumerable:!1,configurable:!0,writable:!0,value:function(e,a){return v(a.card.body,(function(a){return a.behavior===e}))}}),a}(S),w=function(e){function a(){var a=null!==e&&e.apply(this,arguments)||this;return Object.defineProperty(a,"name",{enumerable:!0,configurable:!0,writable:!0,value:b.i18n("3712972d84adf48acbd6ad24b4d75ad0")}),Object.defineProperty(a,"isBaseComponent",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(a,"description",{enumerable:!0,configurable:!0,writable:!0,value:b.i18n("860827796ce2fa94e9ee39e53f011ec0")}),Object.defineProperty(a,"order",{enumerable:!0,configurable:!0,writable:!0,value:-1e3}),Object.defineProperty(a,"icon",{enumerable:!0,configurable:!0,writable:!0,value:"fa fa-align-justify"}),Object.defineProperty(a,"scaffold",{enumerable:!0,configurable:!0,writable:!0,value:{type:"crud2",mode:"list",listItem:{body:[{type:"container",body:[{type:"tpl",tpl:b.i18n("32c65d8d7431e76029678ec7bb73a5ab"),inline:!1,style:{marginTop:"0",marginBottom:"0",paddingTop:"",paddingBottom:""},wrapperComponent:"h2"},{type:"tpl",tpl:b.i18n("629645f147f378869fe9d7ee2bbc2857"),inline:!1,style:{color:"#9b9b9b",marginTop:"0",marginBottom:"0"}}]}]}}}),a}return r.__extends(a,e),Object.defineProperty(a.prototype,"resolveListField",{enumerable:!1,configurable:!0,writable:!0,value:function(e,a,t){var n,r=e.listFields;if(r&&r.length&&(a.listItem.body=t.resolveViewSchema({setting:e,feat:"List"}),null===(n=e.operators)||void 0===n?void 0:n.length)){var i=[];g.forEach((function(a){var n;(null===(n=e.operators)||void 0===n?void 0:n.includes(a.value))&&i.push(a.resolveSchema(e,t))})),a.listItem.body.push({type:"button-group",buttons:i})}}}),Object.defineProperty(a.prototype,"existOperator",{enumerable:!1,configurable:!0,writable:!0,value:function(e,a){return v(a.listItem.body,(function(a){return a.behavior===e}))}}),a}(S);l.registerEditorPlugin(_),l.registerEditorPlugin(P),l.registerEditorPlugin(w),a.CRUDPlugin=S,a.CardsCRUDPlugin=P,a.ListCRUDPlugin=w,a.TableCRUDPlugin=_}));