amis.define("95d0f3c",(function(e,t,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=e("849c8c1"),o=e("cc4bbf0"),l=e("3c5b02d"),i=e("af1cc81"),d=e("167c905"),u=e("520d1e1"),c=e("dfab2bb"),s=e("3c006bc"),f=e("fb32b1a");function b(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var p=b(o),m=b(i),g=b(s),h="ae-FeatureControl",v=function(e){function t(a){var n=e.call(this,a)||this;return Object.defineProperty(n,"sortable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n,"drag",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),n.state=t.initState(a.data,a.features),n}return r.__extends(t,e),Object.defineProperty(t,"getDerivedStateFromProps",{enumerable:!1,configurable:!0,writable:!0,value:function(e,a){return t.initState(e.data,e.features,a.inUseFeat,a.unUseFeat)}}),Object.defineProperty(t,"initState",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,a,n){var r=[],o=[];return Array.isArray(t)||(t=t(e)),t.forEach((function(t){var a;null==t.isActive||(null===(a=t.isActive)||void 0===a?void 0:a.call(t,e))?r.push(t):t.add&&o.push(t)})),{inUseFeat:r,unUseFeat:o}}}),Object.defineProperty(t.prototype,"handleRemove",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var a,n=this.props,r=n.removeFeature,o=n.data,l=n.onBulkChange,i=this.state,d=i.inUseFeat,c=i.unUseFeat;null===(a=e.remove)||void 0===a||a.call(e,o),null==r||r(e,o),null==l||l(o),u.remove(d,e),e.add&&c.push(e),this.setState({inUseFeat:d,unUseFeat:c})}}),Object.defineProperty(t.prototype,"handleAdd",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t,a=this.props,n=a.addFeature,r=a.data,o=a.onBulkChange,l=this.state,i=l.inUseFeat,d=l.unUseFeat;i.push(e),u.remove(d,e);var c=u.clone(r);null===(t=e.add)||void 0===t||t.call(e,c),null==n||n(e,c),null==o||o(c)}}),Object.defineProperty(t.prototype,"dragRef",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this.props.sortable&&(!this.drag&&e?this.initDragging():this.drag&&!e&&this.destroyDragging(),this.drag=e)}}),Object.defineProperty(t.prototype,"initDragging",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this,t=l.findDOMNode(this);this.sortable=new g.default(t.querySelector(".".concat(h,"-features")),{group:"FeatureControlGroup",animation:150,handle:".".concat(h,"Item-dragBar"),ghostClass:"".concat(h,"Item-dragging"),onEnd:function(t){if(t.newIndex!==t.oldIndex){var a=t.to;t.newIndex<t.oldIndex&&t.oldIndex<a.childNodes.length-1?a.insertBefore(t.item,a.childNodes[t.oldIndex+1]):t.oldIndex<a.childNodes.length-1?a.insertBefore(t.item,a.childNodes[t.oldIndex]):a.appendChild(t.item);var n=e.state.inUseFeat.concat();n[t.oldIndex]=n.splice(t.newIndex,1,n[t.oldIndex])[0],e.setState({inUseFeat:n},(function(){var t,a;null===(a=(t=e.props).onSort)||void 0===a||a.call(t,n)}))}}})}}),Object.defineProperty(t.prototype,"destroyDragging",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.sortable&&this.sortable.destroy()}}),Object.defineProperty(t.prototype,"renderItem",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var a=this,n=this.props,r=n.sortable,o=n.goFeatureComp;n.node;var l=n.manager,i=null;return i=o?p.default.createElement(c.GoConfigControl,{className:m.default("".concat(h,"Item-go")),label:e.label,manager:l,compId:function(){return o(e)}}):p.default.createElement("div",{className:m.default("".concat(h,"Item-label"))},e.label),p.default.createElement("li",{className:h+"Item",key:t},r&&p.default.createElement("a",{className:h+"Item-dragBar"},p.default.createElement(d.Icon,{icon:"drag-bar",className:"icon"})),i,p.default.createElement(d.Button,{className:h+"Item-action",onClick:function(){return a.handleRemove(e,t)}},p.default.createElement(d.Icon,{icon:"delete-btn",className:"icon"})))}}),Object.defineProperty(t.prototype,"renderAction",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this,t=this.props,a=t.addable,n=t.addText,r=t.render;return a?r("action",{type:"dropdown-button",closeOnClick:!0,label:f.i18n("b58c7549c0246c55b9cac96383200338")||n,className:"".concat(h,"-action"),btnClassName:"".concat(h,"-action--btn"),menuClassName:"".concat(h,"-action--menus"),buttons:this.state.unUseFeat.map((function(t){return{label:t.label,onClick:function(){return e.handleAdd(t)}}}),{popOverContainer:null})}):null}}),Object.defineProperty(t.prototype,"render",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this,t=this.props.className;return p.default.createElement("div",{className:m.default("ae-FeatureControl",t)},p.default.createElement("ul",{className:m.default("ae-FeatureControl-features"),ref:this.dragRef},this.state.inUseFeat.map((function(t,a){return e.renderItem(t,a)}))),this.renderAction())}}),r.__decorate([d.autobind,r.__metadata("design:type",Function),r.__metadata("design:paramtypes",[Object,Number]),r.__metadata("design:returntype",void 0)],t.prototype,"handleRemove",null),r.__decorate([d.autobind,r.__metadata("design:type",Function),r.__metadata("design:paramtypes",[Object]),r.__metadata("design:returntype",void 0)],t.prototype,"handleAdd",null),r.__decorate([d.autobind,r.__metadata("design:type",Function),r.__metadata("design:paramtypes",[Object]),r.__metadata("design:returntype",void 0)],t.prototype,"dragRef",null),t}(p.default.Component);!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r.__extends(t,e),t=r.__decorate([d.FormItem({type:"ae-feature-control"})],t)}(v),t.default=v}));