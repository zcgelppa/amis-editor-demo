amis.define("d2ff747",(function(e,a,t,n){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e("849c8c1"),r=e("cc4bbf0"),l=e("ebad003"),o=e("600008f"),d=e("af1cc81"),u=e("167c905"),s=e("8ba532b"),c=e("189d04f"),p=e("bdc8375"),f=e("fb32b1a");function v(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var m=v(r),h=v(l),b=v(o),y=v(d),g=function(e){function a(a){var t=e.call(this,a)||this;return t.state={avaliableValids:t.getAvaliableValids(a)},t}return i.__extends(a,e),Object.defineProperty(a.prototype,"componentWillReceiveProps",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(this.props.data.type!==e.data.type){this.setState({avaliableValids:this.getAvaliableValids(e)});var a=this.transformValid(this.props.data);this.updateValidation(a)}}}),Object.defineProperty(a.prototype,"getAvaliableValids",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var a=e.data,t=e.tag;return t="string"==typeof t?t:t(a),p.getValidatorsByTag(t)}}),Object.defineProperty(a.prototype,"transformValid",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var a=e.required,t=e.validations,n=e.validationErrors,i=[];return a&&i.push({name:"required",value:!0,message:null==n?void 0:n.required}),t&&Object.keys(t).forEach((function(e){i.push({name:e,value:t[e],message:null==n?void 0:n[e]})})),i}}),Object.defineProperty(a.prototype,"updateValidation",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var a=this.props.onBulkChange;if(e.length){var t=void 0,n={},i={};e.forEach((function(e){var a=e.name,r=e.value,l=e.message;"required"!==a?null!=r&&(n[a]=r,l&&(i[a]=l)):t=r})),a&&a({required:t,validations:Object.keys(n).length?n:void 0,validationErrors:Object.keys(i).length?i:void 0})}else a&&a({required:void 0,validations:void 0,validationErrors:void 0})}}),Object.defineProperty(a.prototype,"handleAddValidator",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var a=this.transformValid(this.props.data);a.push({name:e.name,value:!e.schema||"",message:""}),this.updateValidation(a)}}),Object.defineProperty(a.prototype,"handleEditRule",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var a=this.transformValid(this.props.data),t=a.find((function(a){return a.name===e.name}));t?(t.value=e.value,t.message=e.message):a.push(e),this.updateValidation(a)}}),Object.defineProperty(a.prototype,"handleRemoveRule",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var a=this.transformValid(this.props.data);b.default(a,(function(a){return a.name===e})),this.updateValidation(a)}}),Object.defineProperty(a.prototype,"handleSwitchRule",{enumerable:!1,configurable:!0,writable:!0,value:function(e,a){var t=this.transformValid(this.props.data),n=t.find((function(e){return e.name===a.name}));n||(n={name:a.name},t.push(n)),n.value=e?a.value:void 0,n.message=e?a.message:void 0,this.updateValidation(t)}}),Object.defineProperty(a.prototype,"renderDropdown",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this,a=this.props,t=a.render,n=a.validations,i=void 0===n?{}:n,r=this.state.avaliableValids.moreValidators,l=Object.values(r).filter((function(e){return!i.hasOwnProperty(e.name)})),o=Object.entries(h.default(l,"group")).map((function(a){return{label:a[0],children:a[1].map((function(a){return{label:a.label,onClick:function(){return e.handleAddValidator(a)}}}))}}));return m.default.createElement("div",{className:"ae-ValidationControl-dropdown"},t("validation-control-dropdown",{type:"dropdown-button",btnClassName:"ae-ValidationControl-dropdown-btn",menuClassName:"ae-ValidationControl-dropdown-menu",level:"link",size:"md",icon:"fa fa-plus",label:"",tooltip:f.i18n("442781667396d6eff51113f482d89e54"),placement:"left",align:"right",tooltipTrigger:"hover",closeOnClick:!0,closeOnOutside:!0,hideCaret:!0,disabled:0===o.length,buttons:o},{key:"validation-control-dropdown",popOverContainer:null}))}}),Object.defineProperty(a.prototype,"renderValidaton",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e,a,t,n=this,i=null===(t=null===(a=null===(e=this.props)||void 0===e?void 0:e.env)||void 0===a?void 0:a.theme)||void 0===t?void 0:t.classPrefix,r=this.state.avaliableValids,l=r.defaultValidators,o=r.moreValidators,d=r.builtInValidators,u=this.transformValid(this.props.data),s=[];return u=u.concat(),Object.keys(l).forEach((function(e){var a=b.default(u,(function(a){return a.name===e}));s.push(m.default.createElement(c.default,{key:e,validator:l[e],data:a.length?a[0]:{name:e},classPrefix:i,isDefault:l.hasOwnProperty(e),onEdit:n.handleEditRule,onDelete:n.handleRemoveRule,onSwitch:n.handleSwitchRule}))})),Object.keys(d).forEach((function(e){var a=b.default(u,(function(a){return a.name===e}));s.push(m.default.createElement(c.default,{key:e,validator:d[e],data:a.length?a[0]:{name:e,value:!0,isBuiltIn:!0},classPrefix:i,isDefault:d.hasOwnProperty(e),onEdit:n.handleEditRule,onDelete:n.handleRemoveRule,onSwitch:n.handleSwitchRule}))})),u.length&&u.forEach((function(e){var a=o[e.name]||p.getValidator(e.name);a&&s.push(m.default.createElement(c.default,{key:e.name,data:e,classPrefix:i,validator:a,isDefault:l.hasOwnProperty(e.name),onEdit:n.handleEditRule,onDelete:n.handleRemoveRule,onSwitch:n.handleSwitchRule}))})),m.default.createElement("div",{className:"ae-ValidationControl-rules",key:"rules"},s)}}),Object.defineProperty(a.prototype,"render",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this.props.className;return m.default.createElement("div",{className:y.default("ae-ValidationControl",e),key:"validation-control"},this.renderDropdown(),this.renderValidaton())}}),i.__decorate([s.autobind,i.__metadata("design:type",Function),i.__metadata("design:paramtypes",[Object]),i.__metadata("design:returntype",void 0)],a.prototype,"handleEditRule",null),i.__decorate([s.autobind,i.__metadata("design:type",Function),i.__metadata("design:paramtypes",[String]),i.__metadata("design:returntype",void 0)],a.prototype,"handleRemoveRule",null),i.__decorate([s.autobind,i.__metadata("design:type",Function),i.__metadata("design:paramtypes",[Boolean,Object]),i.__metadata("design:returntype",void 0)],a.prototype,"handleSwitchRule",null),a}(m.default.Component);!function(e){function a(){return null!==e&&e.apply(this,arguments)||this}i.__extends(a,e),a=i.__decorate([u.FormItem({type:"ae-validationControl",renderLabel:!1})],a)}(g),a.default=g}));